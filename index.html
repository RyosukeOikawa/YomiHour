<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>よみあわー</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  </head>
  <body>
    <form name="form">
      <textarea id="text" name="text" rows="5"></textarea><br>
      <input id="btn" type="button" value="読み上げる" onClick="convertYomi()">
    </form>
  </body>
  <script type=text/javascript>

    // 連想配列を仮定義
    var kanjiDB = [
      {  "kanji" : "地",  "yomi" : "じめんのじ"},
      {  "kanji" : "方",  "yomi" : "ほうがくのほう"},
      {  "kanji" : "自",  "yomi" : "じぶんのじ"},
      {  "kanji" : "治",  "yomi" : "とうちのち"},
    ];

    // テキストを音読みに変換
    function convertYomi(){
      // 入力されたテキストを取得する
      var law = document.getElementById("text").value
      // 読み上げるための文字列を定義
      var yomiageText = '';
      // 読みに変換
      for (var i=0; i<law.length; i++){
        // unicodeを取得
        var unicode = law.charCodeAt(i);
        // 漢字の場合
        if((unicode>=0x4e00 && unicode<=0x9fcf) || (unicode>=0x3400 && unicode<=0x4dbf) || (unicode>=0x20000 && unicode<=0x2a6df) || (unicode>=0xf900 && unicode<=0xfadf) || (unicode>=0x2f800 && unicode<=0x2fa1f))　{
          // 漢字DBから入力値の漢字と一致する読みを取得
          $.grep(kanjiDB,
            function(item, index) {
              if (item.kanji == law.charAt(i)) {
                // yomiageTextに追加
                yomiageText += item.yomi;
              }
            }
          )
        // 漢字でない場合
        } else {
          // yomiageTextに追加
          yomiageText += law.charAt(i);
        }
      }
      readText(yomiageText);
    };

    // 読みあげる
    function readText(yomiageText){
      // 読み上げAPIのインスタンス化
      var msg = new SpeechSynthesisUtterance();
      var voices = window.speechSynthesis.getVoices();
      // APIの音声設定
      msg.voice = voices[7];
      msg.volume = 1.0; // 音量
      msg.rate = 0.1;   // 速度
      msg.pitch = 1.0;　// 音程 min 0 ~ max 2
      msg.lang = 'ja-JP';　// 日本語
      // 読み上げる
      msg.text = yomiageText;
      speechSynthesis.speak(msg);
    }

  </script>
</html>
